{"abi":[{"constant":false,"inputs":[{"name":"_user","type":"address"}],"name":"deactivateUser","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_newLogic","type":"address"}],"name":"update","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"getRolesRights","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_user","type":"address"},{"name":"_rights","type":"uint256"}],"name":"setRoles","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_user","type":"address"},{"name":"_organization","type":"string"}],"name":"setUser","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"userContractLookup","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"db","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_newOwner","type":"address"}],"name":"changeOwner","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_role","type":"uint8"},{"name":"_caller","type":"address"}],"name":"isRole","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"getFullUser","outputs":[{"name":"_organization","type":"string"},{"name":"_roles","type":"uint256"},{"name":"_active","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"doesUserExist","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_database","type":"address"},{"name":"_admin","type":"address"}],"name":"init","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[{"name":"_userContractLookup","type":"address"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"_newOwner","type":"address"}],"name":"LogChangeOwner","type":"event"}],"bytecode":"60806040523480156200001157600080fd5b5060405160208062001507833981018060405262000033919081019062000078565b60008054600160a060020a03909216600160a060020a0319928316811790915560018054909216179055620000cd565b6000620000718251620000b4565b9392505050565b6000602082840312156200008b57600080fd5b600062000099848462000063565b949350505050565b6000620000ae82620000c1565b92915050565b6000620000ae82620000a1565b600160a060020a031690565b61142a80620000dd6000396000f3fe608060405234801561001057600080fd5b50600436106100fc576000357c0100000000000000000000000000000000000000000000000000000000900480634d655aff116100a9578063bb5a389e11610083578063bb5a389e146101bd578063c7af3efc146101dd578063ecb41054146101ff578063f09a401614610212576100fc565b80634d655aff1461018d5780638da5cb5b14610195578063a6f9dae1146101aa576100fc565b806333a3ad8f116100da57806333a3ad8f146101525780633f1a51b81461016557806344724c8c14610178576100fc565b80631a47767b146101015780631c1b877214610116578063265209f214610129575b600080fd5b61011461010f366004610dc9565b610225565b005b610114610124366004610dc9565b61033c565b61013c610137366004610dc9565b6103ec565b60405161014991906112e3565b60405180910390f35b610114610160366004610e9d565b610494565b610114610173366004610e47565b61069b565b6101806107b8565b6040516101499190611238565b6101806107c7565b61019d6107d6565b60405161014991906111bc565b6101146101b8366004610dc9565b6107e5565b6101d06101cb366004610eeb565b6108aa565b604051610149919061122a565b6101f06101eb366004610dc9565b610a09565b60405161014993929190611246565b6101d061020d366004610dc9565b610acd565b610114610220366004610e0d565b610b75565b600061023181336108aa565b1515610260576040516000805160206113d18339815191528152600401610257906112b3565b60405180910390fd5b61026b6000836108aa565b158015610280575061027e6001836108aa565b155b801561029457506102926002836108aa565b155b15156102ba576040516000805160206113d1833981519152815260040161025790611273565b6002546040517f88e084ca000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906388e084ca906103069085906000906004016111ca565b600060405180830381600087803b15801561032057600080fd5b505af1158015610334573d6000803e3d6000fd5b505050505050565b600054600160a060020a0316331461036e576040516000805160206113d18339815191528152600401610257906112c3565b6002546040517fa6f9dae1000000000000000000000000000000000000000000000000000000008152600160a060020a039091169063a6f9dae1906103b79084906004016111bc565b600060405180830381600087803b1580156103d157600080fd5b505af11580156103e5573d6000803e3d6000fd5b5050505050565b6002546040517fc7af3efc000000000000000000000000000000000000000000000000000000008152600091600160a060020a03169063c7af3efc906104369085906004016111bc565b60006040518083038186803b15801561044e57600080fd5b505afa158015610462573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261048a9190810190610f0a565b6020015192915050565b60006104a081336108aa565b15156104c6576040516000805160206113d18339815191528152600401610257906112b3565b600154604080517f5c7460d600000000000000000000000000000000000000000000000000000000815290518592600160a060020a031691635c7460d6916004808301926020929190829003018186803b15801561052357600080fd5b505afa158015610537573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525061055b9190810190610def565b600160a060020a031663ecb41054826040518263ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004016105a291906111bc565b60206040518083038186803b1580156105ba57600080fd5b505afa1580156105ce573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506105f29190810190610ecd565b1515610618576040516000805160206113d18339815191528152600401610257906112d3565b6002546040517f33a3ad8f000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906333a3ad8f90610663908790879060040161120f565b600060405180830381600087803b15801561067d57600080fd5b505af1158015610691573d6000803e3d6000fd5b5050505050505050565b60006106a781336108aa565b15156106cd576040516000805160206113d18339815191528152600401610257906112b3565b606083838080601f016020809104026020016040519081016040528093929190818152602001838380828437600092018290525084519495509093119250610732915050576040516000805160206113d18339815191528152600401610257906112a3565b6002546040517f3f1a51b8000000000000000000000000000000000000000000000000000000008152600160a060020a0390911690633f1a51b89061077f908890889088906004016111e5565b600060405180830381600087803b15801561079957600080fd5b505af11580156107ad573d6000803e3d6000fd5b505050505050505050565b600154600160a060020a031681565b600254600160a060020a031681565b600054600160a060020a031681565b600054600160a060020a03163314610817576040516000805160206113d18339815191528152600401610257906112c3565b600160a060020a0381161515610847576040516000805160206113d1833981519152815260040161025790611293565b6000805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0383161790556040517f95fd54179c11867fb083dd94347ea50f144dd4cfd7612b7bca169f162824af169061089f9083906111bc565b60405180910390a150565b600080600160009054906101000a9004600160a060020a0316600160a060020a0316635c7460d66040518163ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040160206040518083038186803b15801561091757600080fd5b505afa15801561092b573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525061094f9190810190610def565b600160a060020a031663265209f2846040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040161099691906111bc565b60206040518083038186803b1580156109ae57600080fd5b505afa1580156109c2573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506109e69190810190610f3f565b905060008460058111156109f657fe5b60020a9190911615159150505b92915050565b6060600080610a16610c46565b6002546040517fc7af3efc000000000000000000000000000000000000000000000000000000008152600160a060020a039091169063c7af3efc90610a5f9088906004016111bc565b60006040518083038186803b158015610a7757600080fd5b505afa158015610a8b573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610ab39190810190610f0a565b805160208201516040909201519097919650945092505050565b6002546040517fc7af3efc000000000000000000000000000000000000000000000000000000008152600091600160a060020a03169063c7af3efc90610b179085906004016111bc565b60006040518083038186803b158015610b2f57600080fd5b505afa158015610b43573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610b6b9190810190610f0a565b6040015192915050565b600054600160a060020a03163314610ba7576040516000805160206113d18339815191528152600401610257906112c3565b600254600160a060020a031615610bd8576040516000805160206113d1833981519152815260040161025790611283565b6002805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0384811691909117918290556040517f33a3ad8f0000000000000000000000000000000000000000000000000000000081529116906333a3ad8f9061030690849060019060040161120f565b60606040519081016040528060608152602001600081526020016000151581525090565b6000610c76823561134d565b9392505050565b6000610c76825161134d565b6000610c768251611358565b6000610c76823561136c565b600080601f83018413610cb357600080fd5b50813567ffffffffffffffff811115610ccb57600080fd5b602083019150836001820283011115610ce357600080fd5b9250929050565b6000601f82018313610cfb57600080fd5b8151610d0e610d0982611318565b6112f1565b91508082526020830160208301858383011115610d2a57600080fd5b610d35838284611396565b50505092915050565b600060608284031215610d5057600080fd5b610d5a60606112f1565b825190915067ffffffffffffffff811115610d7457600080fd5b610d8084828501610cea565b8252506020610d9184848301610dbd565b6020830152506040610da584828501610c89565b60408301525092915050565b6000610c768235611369565b6000610c768251611369565b600060208284031215610ddb57600080fd5b6000610de78484610c6a565b949350505050565b600060208284031215610e0157600080fd5b6000610de78484610c7d565b60008060408385031215610e2057600080fd5b6000610e2c8585610c6a565b9250506020610e3d85828601610c6a565b9150509250929050565b600080600060408486031215610e5c57600080fd5b6000610e688686610c6a565b935050602084013567ffffffffffffffff811115610e8557600080fd5b610e9186828701610ca1565b92509250509250925092565b60008060408385031215610eb057600080fd5b6000610ebc8585610c6a565b9250506020610e3d85828601610db1565b600060208284031215610edf57600080fd5b6000610de78484610c89565b60008060408385031215610efe57600080fd5b6000610e2c8585610c95565b600060208284031215610f1c57600080fd5b815167ffffffffffffffff811115610f3357600080fd5b610de784828501610d3e565b600060208284031215610f5157600080fd5b6000610de78484610dbd565b610f668161134d565b82525050565b610f6681611358565b610f668161137f565b6000610f8a8385611344565b9350610f9783858461138a565b610fa0836113c6565b9093019392505050565b6000610fb582611340565b610fbf8185611344565b9350610fcf818560208601611396565b610fa0816113c6565b6000610fe5602483611344565b7f757365722068617320616e2061646d696e20726f6c6520617420746865206d6f81527f6d656e7400000000000000000000000000000000000000000000000000000000602082015260400192915050565b6000611044601683611344565b7f646220616c726561647920696e697469616c697a656400000000000000000000815260200192915050565b600061107d601883611344565b7f307830206173206f776e6572206e6f7420616c6c6f7765640000000000000000815260200192915050565b60006110b6600c83611344565b7f656d70747920737472696e670000000000000000000000000000000000000000815260200192915050565b60006110ef602483611344565b7f7573657220646f6573206e6f742068617665207468652072657175697265642081527f726f6c6500000000000000000000000000000000000000000000000000000000602082015260400192915050565b600061114e601783611344565b7f6d73672e73656e646572206973206e6f74206f776e6572000000000000000000815260200192915050565b6000611187601383611344565b7f5573657220646f6573206e6f7420657869737400000000000000000000000000815260200192915050565b610f6681611369565b60208101610a038284610f5d565b604081016111d88285610f5d565b610c766020830184610f6c565b604081016111f38286610f5d565b8181036020830152611206818486610f7e565b95945050505050565b6040810161121d8285610f5d565b610c7660208301846111b3565b60208101610a038284610f6c565b60208101610a038284610f75565b606080825281016112578186610faa565b905061126660208301856111b3565b610de76040830184610f6c565b60208082528101610a0381610fd8565b60208082528101610a0381611037565b60208082528101610a0381611070565b60208082528101610a03816110a9565b60208082528101610a03816110e2565b60208082528101610a0381611141565b60208082528101610a038161117a565b60208101610a0382846111b3565b60405181810167ffffffffffffffff8111828210171561131057600080fd5b604052919050565b600067ffffffffffffffff82111561132f57600080fd5b506020601f91909101601f19160190565b5190565b90815260200190565b6000610a038261135d565b151590565b600160a060020a031690565b90565b60006006821061137b57600080fd5b5090565b6000610a038261134d565b82818337506000910152565b60005b838110156113b1578181015183820152602001611399565b838111156113c0576000848401525b50505050565b601f01601f19169056fe08c379a000000000000000000000000000000000000000000000000000000000a265627a7a723058207adf10eb2ff7b47d6370a96c9b4b18610269c41fa4acfd0f3710e5f92cdc9d536c6578706572696d656e74616cf50037","contractName":"UserLogic","deployedBytecode":"608060405234801561001057600080fd5b50600436106100fc576000357c0100000000000000000000000000000000000000000000000000000000900480634d655aff116100a9578063bb5a389e11610083578063bb5a389e146101bd578063c7af3efc146101dd578063ecb41054146101ff578063f09a401614610212576100fc565b80634d655aff1461018d5780638da5cb5b14610195578063a6f9dae1146101aa576100fc565b806333a3ad8f116100da57806333a3ad8f146101525780633f1a51b81461016557806344724c8c14610178576100fc565b80631a47767b146101015780631c1b877214610116578063265209f214610129575b600080fd5b61011461010f366004610dc9565b610225565b005b610114610124366004610dc9565b61033c565b61013c610137366004610dc9565b6103ec565b60405161014991906112e3565b60405180910390f35b610114610160366004610e9d565b610494565b610114610173366004610e47565b61069b565b6101806107b8565b6040516101499190611238565b6101806107c7565b61019d6107d6565b60405161014991906111bc565b6101146101b8366004610dc9565b6107e5565b6101d06101cb366004610eeb565b6108aa565b604051610149919061122a565b6101f06101eb366004610dc9565b610a09565b60405161014993929190611246565b6101d061020d366004610dc9565b610acd565b610114610220366004610e0d565b610b75565b600061023181336108aa565b1515610260576040516000805160206113d18339815191528152600401610257906112b3565b60405180910390fd5b61026b6000836108aa565b158015610280575061027e6001836108aa565b155b801561029457506102926002836108aa565b155b15156102ba576040516000805160206113d1833981519152815260040161025790611273565b6002546040517f88e084ca000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906388e084ca906103069085906000906004016111ca565b600060405180830381600087803b15801561032057600080fd5b505af1158015610334573d6000803e3d6000fd5b505050505050565b600054600160a060020a0316331461036e576040516000805160206113d18339815191528152600401610257906112c3565b6002546040517fa6f9dae1000000000000000000000000000000000000000000000000000000008152600160a060020a039091169063a6f9dae1906103b79084906004016111bc565b600060405180830381600087803b1580156103d157600080fd5b505af11580156103e5573d6000803e3d6000fd5b5050505050565b6002546040517fc7af3efc000000000000000000000000000000000000000000000000000000008152600091600160a060020a03169063c7af3efc906104369085906004016111bc565b60006040518083038186803b15801561044e57600080fd5b505afa158015610462573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261048a9190810190610f0a565b6020015192915050565b60006104a081336108aa565b15156104c6576040516000805160206113d18339815191528152600401610257906112b3565b600154604080517f5c7460d600000000000000000000000000000000000000000000000000000000815290518592600160a060020a031691635c7460d6916004808301926020929190829003018186803b15801561052357600080fd5b505afa158015610537573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525061055b9190810190610def565b600160a060020a031663ecb41054826040518263ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004016105a291906111bc565b60206040518083038186803b1580156105ba57600080fd5b505afa1580156105ce573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506105f29190810190610ecd565b1515610618576040516000805160206113d18339815191528152600401610257906112d3565b6002546040517f33a3ad8f000000000000000000000000000000000000000000000000000000008152600160a060020a03909116906333a3ad8f90610663908790879060040161120f565b600060405180830381600087803b15801561067d57600080fd5b505af1158015610691573d6000803e3d6000fd5b5050505050505050565b60006106a781336108aa565b15156106cd576040516000805160206113d18339815191528152600401610257906112b3565b606083838080601f016020809104026020016040519081016040528093929190818152602001838380828437600092018290525084519495509093119250610732915050576040516000805160206113d18339815191528152600401610257906112a3565b6002546040517f3f1a51b8000000000000000000000000000000000000000000000000000000008152600160a060020a0390911690633f1a51b89061077f908890889088906004016111e5565b600060405180830381600087803b15801561079957600080fd5b505af11580156107ad573d6000803e3d6000fd5b505050505050505050565b600154600160a060020a031681565b600254600160a060020a031681565b600054600160a060020a031681565b600054600160a060020a03163314610817576040516000805160206113d18339815191528152600401610257906112c3565b600160a060020a0381161515610847576040516000805160206113d1833981519152815260040161025790611293565b6000805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0383161790556040517f95fd54179c11867fb083dd94347ea50f144dd4cfd7612b7bca169f162824af169061089f9083906111bc565b60405180910390a150565b600080600160009054906101000a9004600160a060020a0316600160a060020a0316635c7460d66040518163ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040160206040518083038186803b15801561091757600080fd5b505afa15801561092b573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525061094f9190810190610def565b600160a060020a031663265209f2846040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040161099691906111bc565b60206040518083038186803b1580156109ae57600080fd5b505afa1580156109c2573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052506109e69190810190610f3f565b905060008460058111156109f657fe5b60020a9190911615159150505b92915050565b6060600080610a16610c46565b6002546040517fc7af3efc000000000000000000000000000000000000000000000000000000008152600160a060020a039091169063c7af3efc90610a5f9088906004016111bc565b60006040518083038186803b158015610a7757600080fd5b505afa158015610a8b573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610ab39190810190610f0a565b805160208201516040909201519097919650945092505050565b6002546040517fc7af3efc000000000000000000000000000000000000000000000000000000008152600091600160a060020a03169063c7af3efc90610b179085906004016111bc565b60006040518083038186803b158015610b2f57600080fd5b505afa158015610b43573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052610b6b9190810190610f0a565b6040015192915050565b600054600160a060020a03163314610ba7576040516000805160206113d18339815191528152600401610257906112c3565b600254600160a060020a031615610bd8576040516000805160206113d1833981519152815260040161025790611283565b6002805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0384811691909117918290556040517f33a3ad8f0000000000000000000000000000000000000000000000000000000081529116906333a3ad8f9061030690849060019060040161120f565b60606040519081016040528060608152602001600081526020016000151581525090565b6000610c76823561134d565b9392505050565b6000610c76825161134d565b6000610c768251611358565b6000610c76823561136c565b600080601f83018413610cb357600080fd5b50813567ffffffffffffffff811115610ccb57600080fd5b602083019150836001820283011115610ce357600080fd5b9250929050565b6000601f82018313610cfb57600080fd5b8151610d0e610d0982611318565b6112f1565b91508082526020830160208301858383011115610d2a57600080fd5b610d35838284611396565b50505092915050565b600060608284031215610d5057600080fd5b610d5a60606112f1565b825190915067ffffffffffffffff811115610d7457600080fd5b610d8084828501610cea565b8252506020610d9184848301610dbd565b6020830152506040610da584828501610c89565b60408301525092915050565b6000610c768235611369565b6000610c768251611369565b600060208284031215610ddb57600080fd5b6000610de78484610c6a565b949350505050565b600060208284031215610e0157600080fd5b6000610de78484610c7d565b60008060408385031215610e2057600080fd5b6000610e2c8585610c6a565b9250506020610e3d85828601610c6a565b9150509250929050565b600080600060408486031215610e5c57600080fd5b6000610e688686610c6a565b935050602084013567ffffffffffffffff811115610e8557600080fd5b610e9186828701610ca1565b92509250509250925092565b60008060408385031215610eb057600080fd5b6000610ebc8585610c6a565b9250506020610e3d85828601610db1565b600060208284031215610edf57600080fd5b6000610de78484610c89565b60008060408385031215610efe57600080fd5b6000610e2c8585610c95565b600060208284031215610f1c57600080fd5b815167ffffffffffffffff811115610f3357600080fd5b610de784828501610d3e565b600060208284031215610f5157600080fd5b6000610de78484610dbd565b610f668161134d565b82525050565b610f6681611358565b610f668161137f565b6000610f8a8385611344565b9350610f9783858461138a565b610fa0836113c6565b9093019392505050565b6000610fb582611340565b610fbf8185611344565b9350610fcf818560208601611396565b610fa0816113c6565b6000610fe5602483611344565b7f757365722068617320616e2061646d696e20726f6c6520617420746865206d6f81527f6d656e7400000000000000000000000000000000000000000000000000000000602082015260400192915050565b6000611044601683611344565b7f646220616c726561647920696e697469616c697a656400000000000000000000815260200192915050565b600061107d601883611344565b7f307830206173206f776e6572206e6f7420616c6c6f7765640000000000000000815260200192915050565b60006110b6600c83611344565b7f656d70747920737472696e670000000000000000000000000000000000000000815260200192915050565b60006110ef602483611344565b7f7573657220646f6573206e6f742068617665207468652072657175697265642081527f726f6c6500000000000000000000000000000000000000000000000000000000602082015260400192915050565b600061114e601783611344565b7f6d73672e73656e646572206973206e6f74206f776e6572000000000000000000815260200192915050565b6000611187601383611344565b7f5573657220646f6573206e6f7420657869737400000000000000000000000000815260200192915050565b610f6681611369565b60208101610a038284610f5d565b604081016111d88285610f5d565b610c766020830184610f6c565b604081016111f38286610f5d565b8181036020830152611206818486610f7e565b95945050505050565b6040810161121d8285610f5d565b610c7660208301846111b3565b60208101610a038284610f6c565b60208101610a038284610f75565b606080825281016112578186610faa565b905061126660208301856111b3565b610de76040830184610f6c565b60208082528101610a0381610fd8565b60208082528101610a0381611037565b60208082528101610a0381611070565b60208082528101610a03816110a9565b60208082528101610a03816110e2565b60208082528101610a0381611141565b60208082528101610a038161117a565b60208101610a0382846111b3565b60405181810167ffffffffffffffff8111828210171561131057600080fd5b604052919050565b600067ffffffffffffffff82111561132f57600080fd5b506020601f91909101601f19160190565b5190565b90815260200190565b6000610a038261135d565b151590565b600160a060020a031690565b90565b60006006821061137b57600080fd5b5090565b6000610a038261134d565b82818337506000910152565b60005b838110156113b1578181015183820152602001611399565b838111156113c0576000848401525b50505050565b601f01601f19169056fe08c379a000000000000000000000000000000000000000000000000000000000a265627a7a723058207adf10eb2ff7b47d6370a96c9b4b18610269c41fa4acfd0f3710e5f92cdc9d536c6578706572696d656e74616cf50037","source":"// Copyright 2018 Energy Web Foundation\n// This file is part of the Origin Application brought to you by the Energy Web Foundation,\n// a global non-profit organization focused on accelerating blockchain technology across the energy sector,\n// incorporated in Zug, Switzerland.\n//\n// The Origin Application is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n// This is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY and without an implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details, at <http://www.gnu.org/licenses/>.\n//\n// @authors: slock.it GmbH; Martin Kuechler, martin.kuchler@slock.it; Heiko Burkhardt, heiko.burkhardt@slock.it\n\npragma solidity ^0.5.0;\npragma experimental ABIEncoderV2;\n\nimport \"../../contracts/Users/UserDB.sol\";\nimport \"../../contracts/Users/RoleManagement.sol\";\nimport \"ew-utils-general-contracts/contracts/Interfaces/Updatable.sol\";\nimport \"../../contracts/Interfaces/RolesInterface.sol\";\nimport \"../../contracts/Interfaces/UserContractLookupInterface.sol\";\n\n\n/// @title The logic-contract for the user-data\n/// @notice this contract will not directly store any data, instead it will store them into the userDB-contract\ncontract UserLogic is RoleManagement, Updatable, RolesInterface {\n\n    /// @notice db user-db for storing the contract\n    UserDB public db;\n\n    /// @notice constructor\n    /// @dev it will also call the RoleManagement-constructor\n    constructor(UserContractLookupInterface _userContractLookup) RoleManagement(_userContractLookup, address(_userContractLookup)) public {}\n\n    /// @notice function to deactive an use, only executable for user-admins\n    /// @param _user the user that should be deactivated\n    function deactivateUser(address _user)\n        external\n        onlyRole(RoleManagement.Role.UserAdmin)\n    {\n        require(\n            !isRole(RoleManagement.Role.UserAdmin,_user)\n            && !isRole(RoleManagement.Role.AssetAdmin,_user)\n            && !isRole(RoleManagement.Role.AgreementAdmin,_user)\n            ,\"user has an admin role at the moment\"\n        );\n\n        db.setUserActive(_user, false);\n    }\n\n    /// @notice Initialises the contract by binding it to a logic contract\n    /// @dev can only be called by the owner (UserContractLookup-Contract)\n    /// @param _database Sets the logic contract\n    function init(address _database, address _admin)\n        external\n        onlyOwner\n    {\n        require(address(db) == address(0x0), \"db already initialized\");\n        db = UserDB(_database);\n        db.setRoles(_admin, 2**uint(RoleManagement.Role.UserAdmin));\n    }\n\n    /// @notice funciton that can be called to create a new user in the storage-contract, only executable for user-admins!\n    /// @notice if the user does not exists yet it will be creates, otherwise the older userdata will be overwritten\n    /// @param _user address of the user\n    /// @param _organization organization the user is representing\n    function setUser(\n        address _user,\n        string calldata _organization\n    )\n        external\n        onlyRole(RoleManagement.Role.UserAdmin)\n    {\n        bytes memory orgBytes = bytes(_organization);\n        require(orgBytes.length>0, \"empty string\");\n        db.setUser(_user, _organization);\n    }\n\n    /// @notice function to set / edit the rights of an user / account, only executable for Top-Admins!\n    /// @param _user user that rights will change\n    /// @param _rights rights encoded as bitmask\n    function setRoles(address _user, uint _rights)\n        external\n        onlyRole(RoleManagement.Role.UserAdmin)\n        userExists(_user)\n    {\n        db.setRoles(_user, _rights);\n    }\n\n    /// @notice function to update the logic of a smart contract\n    /// @param _newLogic contract-address of the new smart contract, replacing the currently active one\n    function update(address _newLogic)\n        external\n        onlyOwner\n    {\n        db.changeOwner(_newLogic);\n    }\n\n    /// @notice function that checks if there is an user for the provided ethereum-address\n    /// @param _user ethereum-address of that user\n    /// @return bool if the user exists\n    function doesUserExist(address _user)\n        external\n        view\n        returns (bool)\n    {\n        return db.getFullUser(_user).active;\n    }\n\n    /// @notice function to return all the data of an user\n    /// @param _user user\n    /// @return returns firstName, surname, organization, street, number, zip, city, country, state, roles and the active-flag\n    function getFullUser(address _user)\n        external\n        view\n        returns (\n            string memory _organization,\n            uint _roles,\n            bool _active\n        )\n    {\n        UserDB.User memory user = db.getFullUser(_user);\n        _organization = user.organization;\n        _roles = user.roles;\n        _active = user.active;\n    }\n\n    /// @notice function to retrieve the rights of an user\n    /// @dev if the user does not exist in the mapping it will return 0x0 thus preventing them from accidently getting any rights\n    /// @param _user user someone wants to know its rights\n    /// @return bitmask with the rights of the user\n    function getRolesRights(address _user)\n        external\n        view\n        returns (uint)\n    {\n        return db.getFullUser(_user).roles;\n    }\n}\n","networks":"{}"}